    <div class="max-w-5xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow p-3 sm:p-4 mb-3 sm:mb-4">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
                <div class="w-full sm:w-auto">
                    <h1 class="text-xl sm:text-2xl font-bold text-gray-900 mb-1">
                        <%= __('CERTIFICATE_INFO_TITLE') %>
                    </h1>
                    <p class="text-xs sm:text-sm text-gray-600"><%= __('CERTIFICATE_INFO_SUBTITLE') %></p>
                </div>
                <a href="/user/details/<%= certInfo.userId %>" 
                   class="w-full sm:w-auto inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-xs sm:text-sm font-medium rounded text-gray-700 bg-white hover:bg-gray-50 touch-action-manipulation min-h-[40px]">
                    ‚Üê <%= __('CERTIFICATE_BACK_TO_USER') %>
                </a>
            </div>
            <div class="mt-3 p-2 bg-green-50 rounded">
                <p class="text-green-700 text-xs sm:text-sm font-semibold">
                    <%= __('CERTIFICATE_CREATED_SUCCESS') %>
                </p>
            </div>
        </div>

        <!-- Certificate Details -->
        <div class="bg-white rounded-lg shadow p-3 sm:p-4 mb-3 sm:mb-4">
            <h2 class="text-base sm:text-lg font-bold text-gray-900 mb-2">
                <%= __('CERTIFICATE_DETAILS_SECTION') %>
            </h2>
            <p class="text-xs text-gray-600 mb-3"><%= __('CERTIFICATE_ENCODED_INFO') %></p>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                <div class="bg-gray-50 p-2 rounded">
                    <dt class="text-xs font-medium text-gray-500 mb-1"><%= __('CERTIFICATE_CN') %></dt>
                    <dd class="text-sm font-mono text-gray-900 break-all"><%= certInfo.certificateDetails.CN %></dd>
                </div>
                <div class="bg-gray-50 p-2 rounded">
                    <dt class="text-xs font-medium text-gray-500 mb-1"><%= __('CERTIFICATE_EMAIL') %></dt>
                    <dd class="text-sm font-mono text-gray-900 break-all"><%= certInfo.certificateDetails.EMAIL %></dd>
                </div>
                <div class="bg-gray-50 p-2 rounded">
                    <dt class="text-xs font-medium text-gray-500 mb-1"><%= __('CERTIFICATE_OU') %></dt>
                    <dd class="text-sm font-mono text-gray-900 break-all"><%= certInfo.certificateDetails.OU %></dd>
                </div>
                <div class="bg-gray-50 p-2 rounded">
                    <dt class="text-xs font-medium text-gray-500 mb-1"><%= __('CERTIFICATE_O') %></dt>
                    <dd class="text-sm font-mono text-gray-900 break-all"><%= certInfo.certificateDetails.O %></dd>
                </div>
                <div class="bg-gray-50 p-2 rounded">
                    <dt class="text-xs font-medium text-gray-500 mb-1"><%= __('CERTIFICATE_C') %></dt>
                    <dd class="text-sm font-mono text-gray-900 break-all"><%= certInfo.certificateDetails.C %></dd>
                </div>
            </div>
        </div>

        <!-- Password Section -->
        <div class="bg-red-50 border border-red-400 rounded-lg shadow p-3 sm:p-4 mb-3 sm:mb-4">
            <h2 class="text-base sm:text-lg font-bold text-red-900 mb-2">
                <%= __('CERTIFICATE_PASSWORD_SECTION') %>
            </h2>
            <div class="bg-red-100 p-2 mb-2 rounded">
                <p class="text-red-800 font-bold text-xs sm:text-sm">
                    <%= __('CERTIFICATE_PASSWORD_WARNING') %>
                </p>
            </div>
            <p class="text-xs text-gray-700 mb-3"><%= __('CERTIFICATE_PASSWORD_INFO') %></p>
            
            <div class="bg-white p-2 rounded border border-red-300">
                <label class="block text-xs font-medium text-gray-700 mb-1">
                    <%= __('CERTIFICATE_PASSWORD_LABEL') %>
                </label>
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="text" 
                           id="cert-password" 
                           value="<%= certInfo.password %>" 
                           readonly
                           class="flex-1 px-2 py-2 text-base sm:text-lg font-mono font-bold bg-gray-100 border border-gray-300 rounded text-center select-all min-h-[40px]"
                           onclick="this.select()">
                    <button onclick="copyPassword()" 
                            class="w-full sm:w-auto px-3 py-2 bg-blue-600 text-white text-xs sm:text-sm font-semibold rounded hover:bg-blue-700 transition touch-action-manipulation min-h-[40px]">
                        <span class="hidden sm:inline"><%= __('CERTIFICATE_COPY_PASSWORD') %></span>
                        <span class="sm:hidden">Kopieren</span>
                    </button>
                </div>
            </div>

            <!-- Download Buttons -->
            <div class="mt-3 text-center flex flex-col sm:flex-row gap-2 items-center justify-center">
                <a href="/user/<%= certInfo.userId %>/download-certificate" 
                   class="inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 bg-green-600 text-white text-sm font-bold rounded hover:bg-green-700 transition touch-action-manipulation min-h-[40px]">
                    ‚Üì <%= __('CERTIFICATE_DOWNLOAD_BUTTON') %>
                </a>
                <a href="/user/ca/download"
                   class="inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 bg-blue-600 text-white text-sm font-bold rounded hover:bg-blue-700 transition touch-action-manipulation min-h-[40px]">
                    üèõÔ∏è CA-Zertifikat herunterladen
                </a>
            </div>
            <div class="mt-2 text-xs text-gray-700 text-center">
                <span>Installiere das <b>CA-Zertifikat</b> auf deinem Ger√§t, damit diesem Server vertraut wird.
            </div>

        </div>

        <!-- Email Template -->
        <div class="bg-white rounded-lg shadow p-3 sm:p-4 mb-3 sm:mb-4">
            <h2 class="text-base sm:text-lg font-bold text-gray-900 mb-2">
                <%= __('CERTIFICATE_TEMPLATE_SECTION') %>
            </h2>
            <p class="text-xs text-gray-600 mb-2"><%= __('CERTIFICATE_TEMPLATE_INFO') %></p>
            
            <button onclick="copyEmailTemplateScreenshot()"
                    class="mb-2 w-full sm:w-auto inline-flex items-center justify-center px-3 py-2 bg-pink-600 text-white text-xs sm:text-sm font-semibold rounded hover:bg-pink-700 transition touch-action-manipulation min-h-[40px]">
                Als Screenshot kopieren
            </button>

            <div id="email-template" style="font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; line-height: 1.5; color: #374151; padding: 20px; border: 1px solid #d1d5db; background-color: #f9fafb;">


    <h2 style="font-size: 1.5rem; font-weight: 700; color: #1d4ed8;">üîí Anleitung: Client-Zertifikat-Installation</h2>

    <div style="background-color: #e0f2fe; border: 1px solid #38bdf8; padding: 1rem; margin-top: 1.5rem; border-radius: 0.5rem;">
        <b>WICHTIG: Damit dein Ger√§t dieser Webseite vertraut, installiere bitte zuerst das beigef√ºgte <u>CA-Zertifikat</u> (ca.crt) auf deinem Ger√§t!</b>
        <ul style="margin-top: 0.7rem; margin-bottom: 0; padding-left: 1.2rem; color: #0369a1; font-size: 0.98em;">
            <li style="margin-bottom: 0.4rem;"><b>Windows:</b> √ñffne die Datei <b>ca.crt</b> per Doppelklick und folge den Anweisungen. W√§hle "Vertrauensw√ºrdige Stammzertifizierungsstelle".</li>
            <li style="margin-bottom: 0.4rem;"><b>Android:</b> √ñffne die Datei <b>ca.crt</b> auf deinem Ger√§t und installiere sie als "VPN und Apps"-Zertifikat.</li>
            <li style="margin-bottom: 0.4rem;"><b>iPhone/iPad:</b> √ñffne die Datei <b>ca.crt</b>, installiere das Profil und aktiviere das Zertifikat unter Einstellungen &gt; Info &gt; Zertifikatsvertrauenseinstellungen.</li>
            <li style="margin-bottom: 0.4rem;"><b>Mac:</b> √ñffne die Datei <b>ca.crt</b> per Doppelklick und w√§hle "Immer vertrauen".</li>
        </ul>
        <div style="margin-top: 0.7rem; color: #0e7490; font-size: 0.97em;">
            <span style="font-size: 0.95em;">Nur nach der Installation erkennt dein Ger√§t diese Webseite als sicher und du kannst dein pers√∂nliches Zertifikat nutzen.</span>
        </div>
    </div>

    <p style="margin-top: 1rem;">Diese Anleitung enth√§lt alle Informationen, die du f√ºr die Installation deines pers√∂nlichen Client-Zertifikats ben√∂tigst.</p>

    <div style="background-color: #f3f4f6; border: 1px solid #d1d5db; padding: 1rem; margin-top: 1.5rem;">
        <p style="margin: 0; font-weight: 700; color: #374151;">Dateiname des Zertifikats:</p>
        <p style="margin: 0.5rem 0 0; font-size: 1.1rem; font-weight: 700; color: #1d4ed8;"><%= certInfo.filename %></p>
    </div>

    <div style="background-color: #ffffff; border: 1px dashed #9ca3af; padding: 1rem; margin-top: 1rem; text-align: center;">
        <p style="margin: 0; color: #4b5563;">Passwort zum Importieren des Zertifikats:</p>
        <p style="font-size: 1.5rem; font-weight: 700; color: #dc2626; margin: 0.5rem 0 0;"><%= certInfo.password %></p>
    </div>

    <div style="background-color: #fffbeb; border: 1px solid #fcd34d; padding: 1rem; margin-top: 1.5rem;">
        <p style="margin: 0; font-weight: 700; color: #b45309;">‚ö†Ô∏è Wichtiger Sicherheitshinweis</p>
        <p style="margin: 0.5rem 0 0; color: #78350f;">Bewahre das Zertifikat und das Passwort sicher auf. Teile diese Informationen niemals mit Dritten. Das Passwort wird nur einmal angezeigt und kann nicht wiederhergestellt werden.</p>
    </div>

    <hr style="border: 0; border-top: 1px solid #d1d5db; margin: 2rem 0;">

    <h3 style="font-size: 1.25rem; font-weight: 600; color: #1d4ed8;">‚öôÔ∏è Installationsanleitungen</h3>

    <h4 style="font-size: 1.125rem; font-weight: 600; color: #3b82f6; margin-top: 1.5rem;">üñºÔ∏è Windows</h4>
    <ol style="list-style-type: decimal; margin-left: 1.5rem; padding-left: 0;">
        <li style="margin-bottom: 0.5rem;">Doppelklicke auf die .p12-Datei.</li>
        <li style="margin-bottom: 0.5rem;">Im Zertifikatimport-Assistenten "Aktueller Benutzer" ausw√§hlen und auf "Weiter" klicken.</li>
        <li style="margin-bottom: 0.5rem;">Dateipfad best√§tigen und erneut auf "Weiter" klicken.</li>
        <li style="margin-bottom: 0.5rem;">Das oben angegebene Passwort eingeben.</li>
        <li style="margin-bottom: 0.5rem;">"Alle Zertifikate in folgendem Speicher speichern" w√§hlen, auf "Durchsuchen" klicken und "Eigene Zertifikate" ausw√§hlen.</li>
        <li style="margin-bottom: 0.5rem;">Assistent mit "Fertig stellen" abschlie√üen.</li>
    </ol>

    <h4 style="font-size: 1.125rem; font-weight: 600; color: #3b82f6; margin-top: 1.5rem;">ü§ñ Android</h4>
    <ol style="list-style-type: decimal; margin-left: 1.5rem; padding-left: 0;">
        <li style="margin-bottom: 0.5rem;">.p12-Datei auf das Android-Ger√§t √ºbertragen.</li>
        <li style="margin-bottom: 0.5rem;">Einstellungen √∂ffnen: <b>Sicherheit</b> ‚Üí <b>Verschl√ºsselung & Anmeldedaten</b>.</li>
        <li style="margin-bottom: 0.5rem;">"Zertifikat installieren" oder "Von Ger√§tespeicher installieren" w√§hlen.</li>
        <li style="margin-bottom: 0.5rem;">"CA-Zertifikat" oder "VPN- und App-Benutzerzertifikat" ausw√§hlen.</li>
        <li style="margin-bottom: 0.5rem;">Zum Speicherort der .p12-Datei navigieren und ausw√§hlen.</li>
        <li style="margin-bottom: 0.5rem;">Passwort eingeben, wenn dazu aufgefordert.</li>
        <li style="margin-bottom: 0.5rem;">Einen Namen vergeben (z.B. "Firmen-Zugang") und Installation best√§tigen.</li>
    </ol>

    <h4 style="font-size: 1.125rem; font-weight: 600; color: #3b82f6; margin-top: 1.5rem;">üì± iOS/iPadOS</h4>
    <ol style="list-style-type: decimal; margin-left: 1.5rem; padding-left: 0;">
        <li style="margin-bottom: 0.5rem;">.p12-Datei per E-Mail an dich selbst senden oder in iCloud Drive hochladen.</li>
        <li style="margin-bottom: 0.5rem;">Datei auf dem iOS-Ger√§t √∂ffnen (z.B. aus der Mail-App).</li>
        <li style="margin-bottom: 0.5rem;">iOS erkennt das Zertifikat und fordert zur Installation auf.</li>
        <li style="margin-bottom: 0.5rem;">Passwort eingeben, wenn dazu aufgefordert.</li>
        <li style="margin-bottom: 0.5rem;">Einstellungen √∂ffnen: <b>Allgemein</b> ‚Üí <b>VPN und Ger√§teverwaltung</b>.</li>
        <li style="margin-bottom: 0.5rem;">Neues Profil aus der Liste ausw√§hlen und auf "Installieren" tippen.</li>
        <li style="margin-bottom: 0.5rem;">Ger√§te-Passcode eingeben, wenn dazu aufgefordert.</li>
        <li style="margin-bottom: 0.5rem;">Installation best√§tigen.</li>
    </ol>
</div>
        </div>
    </div>

<script>
function copyPassword() {
    const passwordInput = document.getElementById('cert-password');
    passwordInput.select();
    document.execCommand('copy');
    
    // Show feedback
    alert('<%= __("CERTIFICATE_PASSWORD_COPIED") %>');
}

// Auto-select password on page load for easy copying
document.addEventListener('DOMContentLoaded', function() {
    const passwordInput = document.getElementById('cert-password');
    passwordInput.focus();
    passwordInput.select();
});

// Copy email template as screenshot to clipboard
async function copyEmailTemplateScreenshot() {
    const el = document.getElementById('email-template');
    if (!el) return;
    html2canvas(el, {backgroundColor: null, scale: 2}).then(async canvas => {
        canvas.toBlob(async function(blob) {
            if (navigator.clipboard && window.ClipboardItem) {
                try {
                    await navigator.clipboard.write([
                        new ClipboardItem({ 'image/png': blob })
                    ]);
                    alert('Screenshot wurde in die Zwischenablage kopiert!');
                } catch (err) {
                    alert('Kopieren als Bild nicht unterst√ºtzt: ' + err);
                }
            } else {
                alert('Kopieren als Bild wird von diesem Browser nicht unterst√ºtzt.');
            }
        }, 'image/png');
    });
}
</script>


